{"posts":[{"title":"Java网络编程初探","content":"今天下午把上传的功能学会了，现在来做一个下载的功能，因为我对Java还比较熟，所以用Java完成了这次的网络编程。这个程序主要分成两个部分，客户端和服务端。将服务端的这个文件：下载到下面这个目录中：这次主要遇到了三个问题：1.客户端程序因为阻塞一直停滞(后附解决方法)2.有时候启动客户端时会有Connectrefused的报错，用命令:lsof-i:端口号查看也未发现端口占用(暂未找到问题原因)客户端的主要代码是这样的:publicclassTCP_Client{publicstaticvoidmain(String[]args)throwsException{//127.0.0.1是本机ip,供我们使用的合法端口范围为1024-65535之间的一个数Socketsocket=newSocket(&quot;127.0.0.1&quot;,8888);InputStreamis=socket.getInputStream();//生成一个test_+时间+随机数的一个名字防止重复Stringfilename=&quot;test_&quot;+System.currentTimeMillis()+&quot;_&quot;+newRandom().nextInt(7777)+&quot;.ico&quot;;FileOutputStreamfos=newFileOutputStream(&quot;PicDownload/&quot;+filename);//将获取到的文件以byte数组的形式存储byte[]resource=newbyte[1024];intlen=0;while((len=is.read(resource))!=-1){fos.write(resource,0,len);}System.out.println(&quot;下载成功&quot;);//关闭各种流fos.close();is.close();socket.close();}}服务端的主要代码是这样的:publicclassTCP_Server{publicstaticvoidmain(String[]args)throwsException{ServerSocketserverSocket=newServerSocket(8888);//获取到会话后才会脱离阻塞状态Socketsocket=serverSocket.accept();FileInputStreamfis=newFileInputStream(&quot;PicResource/favicon.ico&quot;);OutputStreamos=socket.getOutputStream();byte[]resource=newbyte[1024];intlen=0;while((len=fis.read(resource))!=-1){os.write(resource,0,len);}//调用shutdownOutput函数是为了防止接收端一直接收不到产生阻塞socket.shutdownOutput();os.close();fis.close();socket.close();serverSocket.close();}}","link":"https://jackzhou666.github.io/post/java-wang-luo-bian-cheng/"}]}